## A Pyramid CNN for Dense-Leaves SegmentationCreated by Daniel Morris at Michigan State University### Introduction:<img src="https://www.egr.msu.edu/3dvision/Images/DenseLeaves.jpg" width="300"><img src="https://www.egr.msu.edu/3dvision/Images/DenseLeavesSegs.jpg" width="300">Automatic detection and segmentation of overlapping leaves in dense foliage can be a difficult task, particularly for leaves with strong textures and high occlusions.  We propose a pyramid convolutional neural network with multi-scale predictions that detects and discriminates leaf boundaries from interior textures.  Using these detected boundaries, closed-contour boundaries around individual leaves are estimated with a watershed-based algorithm.  The result is an instance segmenter for dense leaves.  Promising segmentation results for leaves in dense foliage are obtained and more details are available in the [paper](https://arxiv.org/abs/1804.01646).### CitationsIf you are using the code/model/data provided here in a publication, please cite our paper:    @INPROCEEDINGS{MorrisPCNN:2018,      author={Daniel D. Morris},      booktitle={2018 15th Conference on Computer and Robot Vision (CRV)},      title={A pyramid CNN for Dense-Leaves Segmentation},      pages={238-245},      doi={10.1109/CRV.2018.00041},      month={May},      year={2018},}### ChangelogThe initial release contains 2 pre-trained models plus code for running the CNN, doing instance segmentation, and for evaluating the results.  We anticipate releasing code for training in the near future.  ### Pretrained modelWe provide the pretrained model and training/testing ### Installing  0. Install and build MatConvNet: http://www.vlfeat.org/matconvnet/ 0. Clone PyramidCNN: https://github.com/dmorris0/PyramidCNN 0. Add the following folders from these repos to the Matlab path:   * `<PyramidCNN>/MatlabCode`  * `<MatConvNet>/matlab`  * `<MatConvNet>/matlab/mex`### Running and EvaluationIn Matlab:    >> cd <PyramidCNN>/Scripts    >> runLeafNetThis will download the DenseLeaves dataset from https://www.egr.msu.edu/denseleaves/, load and run the trained network on the test folder, perform instance segmentation, plot results during the process, and output evaluation.  If something is not working please let me know.